# C++ 虚函数与纯虚函数

## 简介

在 C++ 中，**虚函数**（Virtual Function）和**纯虚函数**（Pure Virtual Function）是实现多态性的关键机制。通过虚函数，基类可以定义接口并提供默认的实现，而纯虚函数则定义抽象接口，强制派生类进行实现。本篇文档将介绍虚函数和纯虚函数的概念、它们的区别及适用场景，并通过示例代码展示如何使用。

------

## 1. 虚函数（Virtual Function）

### 定义

虚函数是基类中使用 `virtual` 关键字修饰的函数，它允许派生类进行**重写**。基类通常提供默认的实现，派生类可以选择重写虚函数来提供不同的行为。

### 特点

- 虚函数可以有默认实现。

- 派生类**可以**重写虚函数，但不是必须的。

- 通过基类指针或引用可以调用派生类的重写版本（实现运行时多态）。

- 示例代码

  ```C++
  #include <iostream>
  
  class Base {
  public:
      virtual void show() {  // 虚函数，基类提供默认实现
          std::cout << "Base class show" << std::endl;
      }
  };
  
  class Derived : public Base {
  public:
      void show() override {  // 派生类重写虚函数
          std::cout << "Derived class show" << std::endl;
      }
  };
  
  int main() {
      Base* basePtr = new Derived();
      basePtr->show();  // 输出：Derived class show
      delete basePtr;
  }
  ```

  在该示例中，基类 `Base` 提供了虚函数 `show()` 的默认实现，派生类 `Derived` 重写了该函数。通过基类指针指向 `Derived` 对象时，调用的依然是 `Derived` 中的 `show()` 方法，表现出了多态性。

  ------

## 2. 纯虚函数（Pure Virtual Function）

### 定义

纯虚函数是没有实现的虚函数，用于定义一个抽象接口。派生类必须**重写**纯虚函数，否则派生类自身也将成为抽象类，不能被实例化。纯虚函数以 `= 0` 表示，意味着没有具体的实现。

### 特点

- 纯虚函数没有实现，基类提供的是接口。
- 派生类**必须**实现纯虚函数。
- 包含纯虚函数的类称为**抽象类**，不能直接实例化。

### 示例代码

```C++
#include <iostream>

class Base {
public:
    virtual void show() = 0;  // 纯虚函数，只有接口没有实现
};

class Derived : public Base {
public:
    void show() override {  // 派生类必须实现纯虚函数
        std::cout << "Derived class show" << std::endl;
    }
};

int main() {
    Base* basePtr = new Derived();
    basePtr->show();  // 输出：Derived class show
    delete basePtr;
}
```

在这个例子中，`Base` 是一个抽象类，定义了纯虚函数 `show()`，没有提供任何实现。`Derived` 类继承自 `Base`，并且必须实现 `show()` 函数。在运行时，通过 `Base` 类型的指针调用 `show()` 时，会调用 `Derived` 的实现。

------

## 3. 虚函数与纯虚函数的区别

| **区别**         | **虚函数**                                       | **纯虚函数**                               |
| ---------------- | ------------------------------------------------ | ------------------------------------------ |
| **实现**         | 有实现，可以在基类中定义默认行为。               | 没有实现，只提供接口，必须由派生类实现。   |
| **是否必须重写** | 子类可以选择重写，重写不是强制的。               | 子类必须实现纯虚函数，重写是强制的。       |
| **实例化**       | 包含虚函数的类可以直接实例化。                   | 包含纯虚函数的类是抽象类，不能直接实例化。 |
| **用途**         | 用于提供可选的多态行为，可以定义默认的行为逻辑。 | 用于定义抽象接口，强制派生类实现具体行为。 |
| **语法**         | `virtual void show() {}`                         | `virtual void show() = 0;`                 |

------

## 4. 适用场景

### 虚函数：

- 当基类提供了默认行为，并且派生类可以选择是否重写该行为时，使用虚函数。
- 适合有**部分共同行为**，但可能需要特定派生类自定义实现的场景。

### 纯虚函数：

- 当你希望设计一个接口，强制所有派生类实现该接口时，使用纯虚函数。
- 适合需要定义**抽象接口**，而具体实现完全由派生类决定的场景。常见于**接口类**和**框架设计**中。

------

## 5. 总结

- **虚函数**允许基类提供默认实现，并允许派生类重写它们。适用于多态性场景，派生类可以选择是否重写虚函数。
- **纯虚函数**定义了抽象接口，基类不提供实现，派生类必须实现该函数。包含纯虚函数的类是抽象类，不能实例化，适用于设计抽象接口和框架。

联系作者： 如果您有任何问题或建议，请联系 535057780@qq.com

------

**许可证**： 本项目遵循 MIT 开源协议。

------

附加说明： 本 README 中的代码均可编译运行，适合 C++ 环境。编译时请确保使用支持虚函数和多态性的编译器版本（如 GCC、Clang、MSVC 等）。